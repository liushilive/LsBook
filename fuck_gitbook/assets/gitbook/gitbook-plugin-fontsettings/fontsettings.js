require(["gitbook","jquery"],function(e,t){function n(){return z}function i(e){z=e,h()}function o(){return S}function a(e){S=e,h()}function s(){e.storage.set("fontState",p),g()}function f(e){e.preventDefault(),p.size>=C||(p.size++,s())}function r(e){e.preventDefault(),p.size<=y||(p.size--,s())}function c(e,t){t&&t instanceof Event&&t.preventDefault();var n=u(e);p.family=n,s()}function l(t,n){n&&n instanceof Event&&n.preventDefault();var i=e.state.$book;0!==p.theme&&i.removeClass("color-theme-"+p.theme);var o=m(t);p.theme=o,0!==p.theme&&i.addClass("color-theme-"+p.theme),s()}function u(e){var n=t.grep(S,function(t){return t.config==e})[0];return n?n.id:0}function m(e){var n=t.grep(z,function(t){return t.config==e})[0];return n?n.id:0}function g(){var n=e.state.$book;t(".font-settings .font-family-list li").removeClass("active"),t(".font-settings .font-family-list li:nth-child("+(p.family+1)+")").addClass("active"),n[0].className=n[0].className.replace(/\bfont-\S+/g,""),n.addClass("font-size-"+p.size),n.addClass("font-family-"+p.family),0!==p.theme&&(n[0].className=n[0].className.replace(/\bcolor-theme-\S+/g,""),n.addClass("color-theme-"+p.theme))}function d(t){var n=u(t.family),i=m(t.theme);p=e.storage.get("fontState",{size:t.size||2,family:n,theme:i}),g()}function h(){v&&e.toolbar.removeButton(v),v=e.toolbar.createButton({icon:"fa fa-font",label:"Font Settings",className:"font-settings",dropdown:[[{text:"A",className:"font-reduce",onClick:r},{text:"A",className:"font-enlarge",onClick:f}],t.map(S,function(e){return e.onClick=function(t){return c(e.config,t)},e}),t.map(z,function(e){return e.onClick=function(t){return l(e.config,t)},e})]})}var v,p,C=4,y=0,z=[{config:"white",text:"White",id:0},{config:"sepia",text:"Sepia",id:1},{config:"night",text:"Night",id:2}],S=[{config:"serif",text:"Serif",id:0},{config:"sans",text:"Sans",id:1}];e.events.bind("start",function(e,t){var n=t.fontsettings;h(),d(n)}),e.fontsettings={enlargeFontSize:f,reduceFontSize:r,setTheme:l,setFamily:c,getThemes:n,setThemes:i,getFamilies:o,setFamilies:a}});